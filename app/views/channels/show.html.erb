<div class="hidden">
  <div id="current_user_id">
    <%= current_user.id %>
  </div>
</div>
<div class="wrapper-messenger">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-2" id="channel-list">
        <p><%= link_to "Create a new channel", new_channel_path %></p>
        <h3><%= @channel.default_name(current_user) %></h3>
        <% if @channel.one_to_one? || @admin %>
          <%= link_to "edit", edit_channel_path(@channel) %>
        <% end %>
        <ul>
          <% @subscriptions.each do |subscription| %>
            <% if !current_user?(subscription.user) %>
              <li><%= subscription.user.alias %></li>
            <% end %>
          <% end %>
        </ul>
        <ul>
          <% current_user.channels.each do |channel| %>
            <li>
              <% if current_user.messages.last == nil %>
                <% current_user.messages.last == 0 %>
              <% end %>
              <div <%= unread_channel_class(current_user, channel, @channel)%> >
                <%= link_to channel.default_name(current_user), channel %>
              </div>
            </li>
          <% end %>
        </ul>
      </div>
      <div class="col-md-10" id="message-box">
        <ul id="messages-table">
          <% @channel.messages.each_with_index do |message, index| %>
            <% if index == @new_messages_limit %>
              New message <hr>
            <% end %>
            <li id="message-container">
              <div id="message-infos">
                <h1><%= message.user.alias %></h1>
                <p> | <%= message.updated_at.strftime("%d/%m/%y Ã  %Hh%M")%></p>
              </div>
              <p><%= message.content %></p>
            </li>
            <div id="delete-btn">
              <% if current_user?(message.user) %>
                  <%= link_to "delete", [@channel, message], method: :delete, data: {confirm: "Are you sure! Do you want delete this post"}  %>
              <% end %>
            </div>
          <% end %>
        </ul>
        <%= simple_form_for [@channel, @message], remote: true do |f| %>
          <%= f.input :content, label: false, id: "chat-text" %>
          <%= f.button :submit, 'Send', id:"submit-btn" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
